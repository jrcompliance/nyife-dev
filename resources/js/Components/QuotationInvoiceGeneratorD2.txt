<template>
    <div class="">
        <!-- Trigger Button -->
        <div class="flex justify-center">
            <button @click="openModal"
                class="bg-primary hover:bg-primary/90 text-white font-semibold px-4 md:px-6 py-2.5 rounded-xl transition-all duration-300 hover:scale-[1.02] shadow-lg flex items-center gap-2">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                </svg>
                Create New Quotation
            </button>
        </div>

        <!-- Modal -->
        <div v-if="isModalOpen" class="modal-overlay" @click.self="closeModal">
            <div class="modal-container">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h1 class="modal-title">
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                        </svg>
                        Quotation Invoice Generator
                    </h1>
                    <button @click="closeModal" class="close-btn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>

                <!-- Modal Body -->
                <div class="modal-body">
                    <p class="subtitle">Fill in the details below to generate your quotation</p>

                    <!-- Client Information -->
                    <div class="section-title">Client Information</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Company Name <span class="required">*</span></label>
                            <input type="text" v-model="formData.companyName" placeholder="Enter company name"
                                :class="{ 'error-input': errors.companyName }">
                            <span v-if="errors.companyName" class="error-text">{{ errors.companyName }}</span>
                        </div>
                        <div class="form-group">
                            <label>Kind Attention To <span class="required">*</span></label>
                            <input type="text" v-model="formData.attentionTo" placeholder="Enter contact person name"
                                :class="{ 'error-input': errors.attentionTo }">
                            <span v-if="errors.attentionTo" class="error-text">{{ errors.attentionTo }}</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Address <span class="required">*</span></label>
                        <textarea v-model="formData.address" placeholder="Enter complete address"
                            :class="{ 'error-input': errors.address }"></textarea>
                        <span v-if="errors.address" class="error-text">{{ errors.address }}</span>
                    </div>


                    <!-- Service Charges -->
                    <div class="section-title">Service Charges</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Platform Charge Type</label>
                            <select v-model="formData.selectedPlanId" @change="updatePlatformCharge">
                                <option value="">Select Plan</option>
                                <option v-for="plan in activePlans" :key="plan.id" :value="plan.id">
                                    {{ plan.name }} - ₹{{ formatCurrency(plan.price) }}
                                </option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Platform Charge Amount (₹)</label>
                            <input type="number" v-model="formData.platformCharge" placeholder="0" min="0" step="0.01" readonly style="background-color: #f9fafb; cursor: not-allowed;">
                        </div>
                        <div class="form-group">
                            <label>Discount (%)</label>
                            <input type="number" v-model="formData.discount" placeholder="0" min="0" max="100" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Wallet Recharge (₹)</label>
                            <input type="number" v-model="formData.walletRecharge" placeholder="0" min="0" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Setup Fee (₹)</label>
                            <input type="number" v-model="formData.setupFee" placeholder="0" min="0" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Customization Fee (₹)</label>
                            <input type="number" v-model="formData.customizationFee" placeholder="0" min="0"
                                step="0.01">
                        </div>
                    </div>

                    <!-- Additional Items -->
                    <div class="additional-items">
                        <div class="additional-header">
                            <div class="section-title no-border">Additional Items (Optional)</div>
                            <button class="btn btn-secondary" @click="addAdditionalItem">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                Add Item
                            </button>
                        </div>

                        <div v-for="(item, index) in additionalItems" :key="index" class="item-row">
                            <div class="form-group">
                                <label>Description</label>
                                <input type="text" v-model="item.description" placeholder="Item description">
                            </div>
                            <div class="form-group">
                                <label>Amount (₹)</label>
                                <input type="number" v-model="item.amount" placeholder="0" min="0" step="0.01">
                            </div>
                            <button class="btn btn-danger" @click="removeAdditionalItem(index)">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path
                                        d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                                    </path>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Summary -->
                    <div class="summary-box">
                        <h3 class="summary-title">Quotation Summary</h3>
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span>₹{{ formatCurrency(calculateSubtotal()) }}</span>
                        </div>
                        <div class="summary-row" v-if="formData.discount > 0">
                            <span>Discount ({{ formData.discount }}%):</span>
                            <span class="text-red-600">-₹{{ formatCurrency(calculateDiscount()) }}</span>
                        </div>
                        <div class="summary-row" v-if="formData.discount > 0">
                            <span>Amount After Discount:</span>
                            <span>₹{{ formatCurrency(calculateAmountAfterDiscount()) }}</span>
                        </div>
                        <div class="summary-row">
                            <span>GST (18%):</span>
                            <span>₹{{ formatCurrency(calculateGST()) }}</span>
                        </div>
                        <div class="summary-row total">
                            <span>TOTAL:</span>
                            <span>₹{{ formatCurrency(calculateTotal()) }}</span>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="btn-group">
                        <button class="btn btn-outline" @click="closeModal">
                            Cancel
                        </button>
                        <button class="btn btn-primary" @click="generatePDF" :disabled="isGenerating">
                            <svg v-if="!isGenerating" width="20" height="20" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            <span v-if="isGenerating">Generating...</span>
                            <span v-else>Generate & Download PDF</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- PDF Template (Hidden) -->
        <div ref="pdfTemplate" class="pdf-template">
            <div class="pdf-content">
                <div class="pdf-header">
                    <div class="company-info">
                        <img src="../../images/nyifeBrand.svg" alt="nyife-logo" class="h-16 aspect-auto"></img>
                        <h2>Complia Services Ltd</h2>
                        <p>nyife.chat | info@nyife.chat | +91 11 430 22 315</p>
                        <p>Plot no.9, Third Floor, Paschim Vihar Extn.</p>
                        <p>Delhi-110063, India</p>
                    </div>
                    <div class="quotation-info">
                        <h3>QUOTATION #{{ quotationNumber }}</h3>
                        <p><strong>Date:</strong> {{ currentDate }}</p>
                        <p><strong>Valid Until:</strong> {{ validUntilDate }}</p>
                    </div>
                </div>

                <div class="client-info">
                    <h4>Kind Attention: {{ formData.attentionTo || 'N/A' }}</h4>
                    <p><strong>Company:</strong> {{ formData.companyName || 'N/A' }}</p>
                    <p><strong>Address:</strong> {{ formData.address || 'N/A' }}</p>
                </div>

                <table class="items-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">#</th>
                            <th>Description</th>
                            <th style="width: 150px; text-align: right;">Amount (₹)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(item, index) in getVisibleItems()" :key="index">
                            <td>{{ index + 1 }}</td>
                            <td>{{ item.description }}</td>
                            <td style="text-align: right;">{{ formatCurrency(item.amount) }}</td>
                        </tr>

                        <div v-for="index in 4 - (getVisibleItems()?.length || 0)" :key="index" class="h-7 w-full">
                        </div>

                    </tbody>
                </table>

                <table class="summary-table">
                    <tr>
                        <td>SUBTOTAL:</td>
                        <td>₹{{ formatCurrency(calculateSubtotal()) }}</td>
                    </tr>
                    <tr v-if="formData.discount > 0">
                        <td>DISCOUNT ({{ formData.discount }}%):</td>
                        <td>-₹{{ formatCurrency(calculateDiscount()) }}</td>
                    </tr>
                    <tr v-if="formData.discount > 0">
                        <td>AMOUNT AFTER DISCOUNT:</td>
                        <td>₹{{ formatCurrency(calculateAmountAfterDiscount()) }}</td>
                    </tr>
                    <tr>
                        <td>GST 18%:</td>
                        <td>₹{{ formatCurrency(calculateGST()) }}</td>
                    </tr>
                    <tr class="total-row">
                        <td>TOTAL:</td>
                        <td>₹{{ formatCurrency(calculateTotal()) }}</td>
                    </tr>
                </table>

                <div class="thank-you-note">
                    <p>Thank you for considering nyife.chat for your communication needs. We appreciate the
                        opportunity to share our quotation and hope you find our platform innovative, reliable,
                        and competitively priced. We look forward to building a long-term partnership and
                        contributing to your business growth.</p>
                </div>

                <div class="terms">
                    <h4>Terms & Conditions</h4>
                    <div class="terms-grid">
                        <div class="term-section">
                            <h5>Prices & Taxes</h5>
                            <p>All prices mentioned in this quotation are exclusive of GST. GST @18% will be
                                applicable over and above the quoted prices.</p>
                        </div>

                        <div class="term-section">
                            <h5>Quotation Validity</h5>
                            <p>This quotation is valid for 30 days from the date of issue. Prices and terms are
                                subject to review after the validity period.</p>
                        </div>

                        <div class="term-section">
                            <h5>Payment Terms</h5>
                            <p>All payments must be made in favour of "Complia Services Ltd." Payment shall be
                                made as per the agreed schedule. Services will commence upon receipt of payment.
                            </p>
                        </div>

                        <div class="term-section">
                            <h5>Scope of Support</h5>
                            <p>Basic setup and standard support are included. Any customization or additional
                                technical support beyond standard scope will be charged separately.</p>
                        </div>

                        <div class="term-section">
                            <h5>Price Revision Clause</h5>
                            <p>In case of any price changes by third-party platforms (Meta, Google, telecom
                                operators), such changes will be passed on to the customer at actual rates.</p>
                        </div>

                        <div class="term-section">
                            <h5>Service Activation & Delivery</h5>
                            <p>Service activation timelines may vary depending on platform approvals. We will make
                                best efforts to ensure timely activation and delivery of services.</p>
                        </div>
                    </div>
                </div>

                <div class="signature">
                    <p>If you have any questions concerning this quotation, please contact us at info@nyife.chat
                    </p>
                    <p class="signature-line">____________________</p>
                    <p class="name">Abhishek Anand</p>
                    <p class="title">Business Manager</p>
                </div>
            </div>
        </div>
    </div>
</template>

<script setup>
import { ref, onMounted, computed } from 'vue';
import html2canvas from 'html2canvas';
import jsPDF from 'jspdf';
import { toast } from 'vue3-toastify';

const props = defineProps({
    plans: {
        type: Object,
        required: true,
    }
});

// use this plans data to get dynamic price
const plans = props.plans.data;

// Compute active plans
const activePlans = computed(() => {
    return plans.filter(plan => plan.status === 'active');
});

const isModalOpen = ref(false);
const isGenerating = ref(false);
const pdfTemplate = ref(null);
const errors = ref({});

const formData = ref({
    companyName: '',
    attentionTo: '',
    address: '',
    selectedPlanId: '',
    platformChargeType: '',
    platformCharge: '',
    walletRecharge: '',
    setupFee: '',
    customizationFee: '',
    discount: 0
});

const additionalItems = ref([]);
const quotationNumber = ref('');
const currentDate = ref('');
const validUntilDate = ref('');

const openModal = () => {
    isModalOpen.value = true;
    errors.value = {};
};

const closeModal = () => {
    isModalOpen.value = false;
    resetForm();
};

const resetForm = () => {
    formData.value = {
        companyName: '',
        attentionTo: '',
        address: '',
        selectedPlanId: '',
        platformChargeType: '',
        platformCharge: '',
        walletRecharge: '',
        setupFee: '',
        customizationFee: '',
        discount: 0
    };
    additionalItems.value = [];
    errors.value = {};
};

const updatePlatformCharge = () => {
    const selectedPlan = activePlans.value.find(plan => plan.id === formData.value.selectedPlanId);
    if (selectedPlan) {
        formData.value.platformCharge = parseFloat(selectedPlan.price);
        formData.value.platformChargeType = selectedPlan.name;
    } else {
        formData.value.platformCharge = '';
        formData.value.platformChargeType = '';
    }
};

const validateForm = () => {
    errors.value = {};
    let isValid = true;

    if (!formData.value.companyName.trim()) {
        errors.value.companyName = 'Company name is required';
        isValid = false;
    }

    if (!formData.value.attentionTo.trim()) {
        errors.value.attentionTo = 'Contact person name is required';
        isValid = false;
    }

    if (!formData.value.address.trim()) {
        errors.value.address = 'Address is required';
        isValid = false;
    }

    if (calculateSubtotal() === 0) {
        toast.error('Please add at least one item with an amount greater than 0');
        isValid = false;
    }

    return isValid;
};

const generateQuotationNumber = () => {
    const prefix = 'KA/';
    const randomNum = Math.floor(1000 + Math.random() * 9000);
    return `${prefix}${randomNum}`;
};

const getCurrentDate = () => {
    const today = new Date();
    const day = String(today.getDate()).padStart(2, '0');
    const month = String(today.getMonth() + 1).padStart(2, '0');
    const year = today.getFullYear();
    return `${day}/${month}/${year}`;
};

const getValidUntilDate = () => {
    const today = new Date();
    today.setDate(today.getDate() + 30);
    const day = String(today.getDate()).padStart(2, '0');
    const month = String(today.getMonth() + 1).padStart(2, '0');
    const year = today.getFullYear();
    return `${day}/${month}/${year}`;
};

const addAdditionalItem = () => {
    additionalItems.value.push({ description: '', amount: '' });
};

const removeAdditionalItem = (index) => {
    additionalItems.value.splice(index, 1);
};

const formatCurrency = (value) => {
    const num = parseFloat(value) || 0;
    return num.toLocaleString('en-IN', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
    });
};

const calculateSubtotal = () => {
    let total = 0;
    if (formData.value.platformCharge) total += parseFloat(formData.value.platformCharge) || 0;
    if (formData.value.walletRecharge) total += parseFloat(formData.value.walletRecharge) || 0;
    if (formData.value.setupFee) total += parseFloat(formData.value.setupFee) || 0;
    if (formData.value.customizationFee) total += parseFloat(formData.value.customizationFee) || 0;

    additionalItems.value.forEach(item => {
        if (item.amount) total += parseFloat(item.amount) || 0;
    });

    return total;
};

const calculateDiscount = () => {
    const discount = parseFloat(formData.value.discount) || 0;
    return calculateSubtotal() * (discount / 100);
};

const calculateAmountAfterDiscount = () => {
    return calculateSubtotal() - calculateDiscount();
};

const calculateGST = () => {
    return calculateAmountAfterDiscount() * 0.18;
};

const calculateTotal = () => {
    return calculateAmountAfterDiscount() + calculateGST();
};

const getVisibleItems = () => {
    const items = [];

    if (parseFloat(formData.value.platformCharge) > 0) {
        items.push({
            description: `Platform Charge (${formData.value.platformChargeType})`,
            amount: parseFloat(formData.value.platformCharge)
        });
    }

    if (parseFloat(formData.value.walletRecharge) > 0) {
        items.push({
            description: 'Wallet Recharge',
            amount: parseFloat(formData.value.walletRecharge)
        });
    }

    if (parseFloat(formData.value.setupFee) > 0) {
        items.push({
            description: 'Setup Fee',
            amount: parseFloat(formData.value.setupFee)
        });
    }

    if (parseFloat(formData.value.customizationFee) > 0) {
        items.push({
            description: 'Customization Fee',
            amount: parseFloat(formData.value.customizationFee)
        });
    }

    additionalItems.value.forEach(item => {
        if (item.description && parseFloat(item.amount) > 0) {
            items.push({
                description: item.description,
                amount: parseFloat(item.amount)
            });
        }
    });

    return items;
};

const generatePDF = async () => {
    if (!validateForm()) {
        return;
    }

    isGenerating.value = true;
    quotationNumber.value = generateQuotationNumber();
    currentDate.value = getCurrentDate();
    validUntilDate.value = getValidUntilDate();

    try {
        await new Promise(resolve => setTimeout(resolve, 200));

        const element = pdfTemplate.value;

        // Show element temporarily for rendering
        element.style.position = 'fixed';
        element.style.left = '0';
        element.style.top = '0';
        element.style.zIndex = '-1';
        element.style.display = 'block';
        element.style.width = '210mm';
        element.style.minHeight = '297mm';

        // High-quality canvas rendering
        const canvas = await html2canvas(element, {
            scale: 4, // Increased scale for better quality
            useCORS: true,
            logging: false,
            backgroundColor: '#ffffff',
            width: 793.7, // A4 width in pixels at 96 DPI
            windowWidth: 793.7,
            onclone: (clonedDoc) => {
                const clonedElement = clonedDoc.querySelector('.pdf-template');
                if (clonedElement) {
                    clonedElement.style.display = 'block';
                    clonedElement.style.width = '210mm';
                }
            }
        });

        // Hide element after rendering
        element.style.display = 'none';
        element.style.position = 'absolute';
        element.style.left = '-9999px';
        element.style.zIndex = '';
        element.style.width = '';
        element.style.minHeight = '';

        // Create PDF with high quality
        const imgData = canvas.toDataURL('image/png', 1.0);
        const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'mm',
            format: 'a4',
            compress: true
        });

        const pdfWidth = 210; // A4 width in mm
        const pdfHeight = 297; // A4 height in mm
        const imgWidth = pdfWidth;
        const imgHeight = (canvas.height * pdfWidth) / canvas.width;

        let heightLeft = imgHeight;
        let position = 0;

        // Add first page
        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight, undefined, 'FAST');
        heightLeft -= pdfHeight;

        // Add additional pages if content overflows
        while (heightLeft > 0) {
            position = heightLeft - imgHeight;
            pdf.addPage();
            pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight, undefined, 'FAST');
            heightLeft -= pdfHeight;
        }

        // Generate filename
        const fileName = `Quotation_${quotationNumber.value.replace('/', '_')}_${formData.value.companyName.replace(/[^a-zA-Z0-9]/g, '_')}.pdf`;

        // Save PDF
        pdf.save(fileName);

        toast.success('Quotation generated and downloaded successfully!');

        // Close modal after successful generation
        setTimeout(() => {
            closeModal();
        }, 1500);

    } catch (error) {
        console.error('Error generating PDF:', error);
        toast.error('Error generating quotation. Please try again.');
    } finally {
        isGenerating.value = false;
    }
};

onMounted(() => {
    quotationNumber.value = generateQuotationNumber();
    currentDate.value = getCurrentDate();
    validUntilDate.value = getValidUntilDate();
});
</script>

<style scoped>
/* Modal Overlay */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    padding: 1rem;
}

/* Modal Container */
.modal-container {
    background: white;
    border-radius: 1rem;
    max-width: 800px;
    width: 100%;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
}

/* Modal Header */
.modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1.5rem;
    border-bottom: 1px solid #e5e7eb;
}

.modal-title {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1.5rem;
    font-weight: 700;
    color: #111827;
}

.close-btn {
    padding: 0.5rem;
    border-radius: 0.5rem;
    transition: background-color 0.2s;
    border: none;
    background: transparent;
    cursor: pointer;
}

.close-btn:hover {
    background-color: #f3f4f6;
}

/* Modal Body */
.modal-body {
    padding: 1.5rem;
    overflow-y: auto;
}

.subtitle {
    color: #6b7280;
    margin-bottom: 1.5rem;
}

/* Section Title */
.section-title {
    font-size: 1.125rem;
    font-weight: 600;
    color: #111827;
    margin: 1.5rem 0 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #e5e7eb;
}

.section-title.no-border {
    border-bottom: none;
    margin-bottom: 0.5rem;
}

/* Form Grid */
.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-bottom: 1rem;
}

/* Form Group */
.form-group {
    display: flex;
    flex-direction: column;
}

.form-group label {
    font-size: 0.875rem;
    font-weight: 500;
    color: #374151;
    margin-bottom: 0.5rem;
}

.required {
    color: #ef4444;
}

.form-group input,
.form-group select,
.form-group textarea {
    padding: 12px 14px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s ease;
    font-family: inherit;
    background: white;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #ff5100;
    box-shadow: 0 0 0 3px rgba(255, 81, 0, 0.1);
}

.form-group input:hover,
.form-group select:hover,
.form-group textarea:hover {
    border-color: #cbd5e0;
}

.error-input {
    border-color: #e53e3e !important;
}

.error-text {
    color: #e53e3e;
    font-size: 12px;
    margin-top: 4px;
}

.form-group textarea {
    resize: vertical;
    min-height: 80px;
}

.section-title {
    font-size: 18px;
    font-weight: 700;
    color: #333;
    margin: 30px 0 15px 0;
    padding-bottom: 10px;
    border-bottom: 2px solid #ff5100;
}

.section-title.no-border {
    margin: 0;
    border: none;
    padding: 0;
}

.additional-items {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 12px;
    margin-top: 20px;
}

.additional-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.item-row {
    display: grid;
    grid-template-columns: 2fr 1fr auto;
    gap: 15px;
    margin-bottom: 15px;
    align-items: end;
}

.btn {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.btn-primary {
    background: #ff5100;
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.btn-secondary {
    background: #48bb78;
    color: white;
}

.btn-secondary:hover {
    background: #38a169;
}

.btn-danger {
    background: #f56565;
    color: white;
    padding: 8px 12px;
}

.btn-danger:hover {
    background: #e53e3e;
}

.btn-group {
    display: flex;
    gap: 15px;
    margin-top: 30px;
    justify-content: center;
}

.summary-box {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin-top: 20px;
}

.summary-title {
    margin-bottom: 15px;
    color: #333;
    font-size: 18px;
}

.summary-row {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    font-size: 15px;
}

.summary-row.total {
    font-size: 20px;
    font-weight: 700;
    color: #ff5100;
    border-top: 2px solid #ddd;
    padding-top: 15px;
    margin-top: 10px;
}

/* PDF Template Styles */
.pdf-template {
    position: absolute;
    left: -9999px;
    display: none;
    width: 793px;
    background-image: url("../../../../images/nyife-bg.png");
    background-size: 70%;
    background-position: center;
    background-repeat: no-repeat;
    padding: 32px;
    font-family: Arial, sans-serif;
}

.pdf-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid #333;
}

.company-info h2 {
    color: #ff5100;
    font-size: 24px;
    margin-bottom: 5px;
}

.company-info p {
    font-size: 11px;
    color: #666;
    margin: 2px 0;
}

.quotation-info {
    text-align: right;
}

.quotation-info h3 {
    font-size: 18px;
    color: #333;
    margin-bottom: 5px;
}

.quotation-info p {
    font-size: 11px;
    color: #666;
    margin: 3px 0;
}

.client-info {
    background: #f8f9fa;
    padding: 16px;
    margin-bottom: 25px;
    border-radius: 5px;
}

.client-info h4 {
    font-size: 13px;
    color: #333;
}

.client-info p {
    font-size: 12px;
    color: #555;
    line-height: 1.6;
    margin: 2px 0;
}

.items-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 25px;
}

.items-table th {
    background: #ff5100;
    color: white;
    padding: 12px;
    text-align: left;
    font-size: 12px;
    font-weight: 600;
}

.items-table td {
    padding: 10px 12px;
    border-bottom: 1px solid #e0e0e0;
    font-size: 12px;
    color: #333;
}

.items-table tr:last-child td {
    border-bottom: none;
}

.summary-table {
    margin-left: auto;
    width: 300px;
    margin-bottom: 30px;
}

.summary-table tr {
    border-bottom: 1px solid #e0e0e0;
}

.summary-table td {
    padding: 10px;
    font-size: 13px;
}

.summary-table td:last-child {
    text-align: right;
    font-weight: 600;
}

.summary-table .total-row {
    background: #ff5100;
    color: white;
    font-size: 16px;
    font-weight: 700;
}

.thank-you-note {
    /* margin-bottom: 20px; */
    padding: 15px;
    background: #ff51000a;
    border-left: 4px solid #ff5100;
}

.thank-you-note p {
    margin: 0;
    color: #333;
    font-size: 11px;
    line-height: 1.6;
}

.terms {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 2px solid #333;
}

.terms h4 {
    font-size: 14px;
    color: #333;
    margin-bottom: 12px;
}

.terms-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.term-section h5 {
    font-size: 11px;
    color: #ff5100;
    margin-bottom: 5px;
    font-weight: 700;
}

.term-section p {
    font-size: 10px;
    color: #555;
    line-height: 1.5;
    margin-bottom: 8px;
}

.signature {
    margin-top: 40px;
    text-align: right;
}

.signature p {
    font-size: 12px;
    color: #333;
    margin: 5px 0;
}

.signature .signature-line {
    margin-top: 20px;
    margin-bottom: 5px;
}

.signature .name {
    font-weight: 700;
    font-size: 14px;
}

.signature .title {
    font-size: 11px;
    color: #666;
}
</style>